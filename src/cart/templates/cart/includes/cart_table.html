{% load static %}

<div class="table-responsive rounded">
    <table class="table table-sm border">
        <thead class="">
            <tr>
                <th scope="col">Product Info</th>
                <th scope="col"></th>
                <th scope="col">Price</th>
                <th scope="col">Qty</th>
                <th scope="col">Subtotal</th>
            </tr>
        </thead>

        {% for item in cart_items %}
        <tr class="">
            <td class="p-3 w-25 ">
                {% if item.product.image %}
                <img class="img-fluid rounded" src="{{ item.product.image.url }}">
                {% else %}
                <img class="img-fluid rounded" src="{% static 'img/no-image.jpg' %}">
                {% endif %}
            </td>
            <td class="py-3">
                <p class="my-0"><strong>{{ item.product.name }}</strong></p>
                {% if item.product.is_a_treatment %}
                <br />
                <p class="small font-weight-bold">Appointment Date and Time:</p>
                <div class="input-group date" id="cart_datetime-{{ forloop.counter }}" data-value="{{ item.datetime }}"
                    data-target-input="nearest">
                    <input type="text" name="datetime" class="form-control datetimepicker-input"
                        value="{{ item.datetime }}" data-target="#cart_datetime-{{ forloop.counter }}" required />
                    <div class="input-group-append" data-target="#cart_datetime-{{ forloop.counter }}" data-toggle="datetimepicker">
                        <div class="input-group-text"><i class="far fa-calendar-alt"></i></div>
                    </div>
                </div>
                {% else %}
                <p class="my-0 small text-muted">SKU: {{ item.product.sku|upper }}</p>
                {% endif %}
            </td>
            <td class="py-3">
                <p class="my-0">€{{ item.product.price }}</p>
            </td>
            <td class="py-3 w-25">
                <p class="my-0">{{ item.quantity }}</p>
            </td>
            <td class="py-3">
                <p class="my-0 font-weight-bold">€{{ item.product.price }}</p>
            </td>
        </tr>
        {% endfor %}
        <tr>
            <td colspan="5" class="pt-5 text-right">
                <h6><strong>Subtotal: €{{ total|floatformat:2 }}</strong></h6>
                <h6>Delivery: €{{ delivery|floatformat:2 }}</h6>
                <h4 class="mt-4"><strong>Grand Total: €{{ grand_total|floatformat:2 }}</strong></h4>
                {% if free_delivery_delta > 0 %}
                <p class="mb-1 text-danger">
                    You could get free delivery by spending just <strong>€{{ free_delivery_delta }}</strong> more!
                </p>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td colspan="5" class="text-right">
                <a href="{% url 'products' %}" class="text-info" id="BackToProduct">
                    <span class="icon">
                        <i class="fas fa-chevron-left"></i>
                    </span>
                    <span class="lead">Continue Shopping</span>
                </a>
                <a href="#" class="ml-2 btn btn-checkout rounded-0 btn-lg">
                    <span class="text-uppercase">Secure Checkout</span>
                    <span class="icon">
                        <i class="fas fa-lock"></i>
                    </span>
                </a>
            </td>
        </tr>
    </table>
</div>